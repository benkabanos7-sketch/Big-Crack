<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Click the Image Game</title>
  <style>
    body { 
      font-family: sans-serif; 
      text-align: center; 
      margin-top: 20px; 
      background: #f0f0f0;
    }
    #game-img {
      width: 150px;
      height: 150px;
      cursor: pointer;
      margin-top: 20px;
      transition: transform 0.1s;
    }
    #game-img:active {
      transform: scale(0.9);
    }
    #leaderboard {
      margin-top: 30px;
      text-align: left;
      display: inline-block;
      background: white;
      padding: 10px 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
    }
    #leaderboard div {
      margin: 5px 0;
    }
    #leaderboard img {
      vertical-align: middle;
      border-radius: 50%;
    }
  </style>
</head>
<body>

<h1>Click the Image!</h1>
<p>Click the image to get points!</p>
<img id="game-img" src="https://cdn.discordapp.com/attachments/991426263552110703/1416839199520460810/noFilter.png?ex=68c99f54&is=68c84dd4&hm=b38d5d041da64256fe8290161d086aa70d4589248e6459a532ebde7f9e2cf7c4&" alt="Click me!">

<h2>Leaderboard</h2>
<div id="leaderboard">
  <p>No players yet.</p>
</div>

<script>
  const img = document.getElementById('game-img');
  const leaderboardEl = document.getElementById('leaderboard');

  // Initialize scores map
  let scores = {};

  // Get current player info
  const selfId = window.DiscordActivity ? window.DiscordActivity.self.id : 'local';
  const players = window.DiscordActivity ? window.DiscordActivity.players : [{id: selfId, username: 'You', avatar: null}];

  // Initialize all scores
  players.forEach(p => scores[p.id] = 0);

  // Function to update leaderboard display
  function updateLeaderboard() {
    leaderboardEl.innerHTML = ''; // clear previous

    players.forEach(player => {
      const score = scores[player.id] || 0;
      const avatarURL = player.avatar 
        ? `https://cdn.discordapp.com/avatars/${player.id}/${player.avatar}.png?size=64`
        : 'https://via.placeholder.com/32'; // fallback

      const entry = document.createElement('div');
      entry.innerHTML = `
        <img src="${avatarURL}" width="32" height="32"> 
        <strong>${player.username}</strong>: ${score}
      `;
      leaderboardEl.appendChild(entry);
    });
  }

  // Initial leaderboard
  updateLeaderboard();

  // Click event
  img.addEventListener('click', () => {
    // Increment current player's score
    scores[selfId] = (scores[selfId] || 0) + 1;

    // Move image to random position
    const maxX = window.innerWidth - img.width - 20;
    const maxY = window.innerHeight - img.height - 20;
    const randomX = Math.floor(Math.random() * maxX);
    const randomY = Math.floor(Math.random() * maxY);

    img.style.position = 'absolute';
    img.style.left = randomX + 'px';
    img.style.top = randomY + 'px';

    // Update leaderboard
    updateLeaderboard();
  });

  // Optional: update leaderboard periodically in case other players click
  if (window.DiscordActivity) {
    setInterval(() => {
      window.DiscordActivity.players.forEach(p => {
        if (!(p.id in scores)) scores[p.id] = 0; // add new players
      });
      updateLeaderboard();
    }, 1000);
  }
</script>

</body>
</html>
